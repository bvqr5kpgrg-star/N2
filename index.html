<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>HELL ISLE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:radial-gradient(circle at center,#0f0f0f,#000 70%);
  color:#eee;
  font-family:monospace;
}
#game{
  max-width:480px;
  margin:auto;
  padding:10px;
}
h1{
  text-align:center;
  letter-spacing:6px;
}

/* ARENA */
#arena{
  height:260px;
  border:2px solid #333;
  background:
    linear-gradient(180deg,#2a2a1a,#111);
  position:relative;
  overflow:hidden;
}
canvas{
  width:100%;
  height:100%;
}

/* UI */
#stats{margin:6px 0}
#hand{
  display:flex;
  gap:8px;
}
.card{
  flex:1;
  background:linear-gradient(135deg,#222,#111);
  border:1px solid #555;
  padding:8px;
  border-radius:6px;
  text-align:center;
  cursor:pointer;
}
.card:hover{
  transform:translateY(-6px);
  box-shadow:0 0 14px crimson;
}

/* FLOAT TEXT */
.float{
  position:absolute;
  font-size:14px;
  animation:float 1s forwards;
}
@keyframes float{
  from{opacity:1;transform:translateY(0)}
  to{opacity:0;transform:translateY(-30px)}
}
</style>
</head>

<body>
<div id="game">
<h1>HELL ISLE</h1>

<div id="arena">
  <canvas id="c" width="460" height="260"></canvas>
</div>

<div id="stats"></div>
<div id="hand"></div>
</div>

<script>
const c=document.getElementById("c");
const ctx=c.getContext("2d");

/* ===== LOAD CHARACTER IMAGE ===== */
const sprite = new Image();
sprite.src = "characters.jpg";

const CHAR_COUNT = 10; // we will pick 10 random crops
let characters = [];

/* Randomly slice characters from image */
sprite.onload = () => {
  const size = Math.min(sprite.width, sprite.height) / 4;
  for(let i=0;i<CHAR_COUNT;i++){
    characters.push({
      x: Math.random() * (sprite.width - size),
      y: Math.random() * (sprite.height - size),
      w: size,
      h: size
    });
  }
  startBattle();
};

/* ===== AUDIO ===== */
const audio=new (window.AudioContext||window.webkitAudioContext)();
function sfx(freq){
  const o=audio.createOscillator(),g=audio.createGain();
  o.frequency.value=freq;
  o.connect(g);g.connect(audio.destination);
  o.start();
  g.gain.exponentialRampToValueAtTime(0.0001,audio.currentTime+0.15);
  o.stop(audio.currentTime+0.15);
}

/* ===== GAME STATE ===== */
let player={
  hp:100,maxHp:100,energy:3,
  deck:[
    {name:"Slash",cost:1,damage:10},
    {name:"Focus",cost:1,heal:8},
    {name:"Burn Blade",cost:2,damage:8}
  ],
  hand:[],
  sprite:null
};

let enemy={
  hp:80,maxHp:80,
  damage:10,
  sprite:null
};

/* ===== DRAW ===== */
function draw(){
  ctx.clearRect(0,0,460,260);

  // Enemy sprite (top)
  if(enemy.sprite){
    ctx.drawImage(
      sprite,
      enemy.sprite.x,enemy.sprite.y,
      enemy.sprite.w,enemy.sprite.h,
      170,20,120,120
    );
  }

  // Player sprite (bottom)
  if(player.sprite){
    ctx.drawImage(
      sprite,
      player.sprite.x,player.sprite.y,
      player.sprite.w,player.sprite.h,
      170,120,120,120
    );
  }

  // HP bars
  ctx.fillStyle="red";
  ctx.fillRect(160,10,(enemy.hp/enemy.maxHp)*140,6);
  ctx.fillRect(160,246,(player.hp/player.maxHp)*140,6);
}

/* ===== CARDS ===== */
function drawHand(){
  const h=document.getElementById("hand");
  h.innerHTML="";
  player.hand.forEach((c,i)=>{
    let d=document.createElement("div");
    d.className="card";
    d.innerHTML=`<b>${c.name}</b><br>⚡${c.cost}`;
    d.onclick=()=>playCard(i);
    h.appendChild(d);
  });
}

/* ===== TURN LOGIC ===== */
function startTurn(){
  player.energy=3;
  player.hand=[];
  for(let i=0;i<3;i++){
    player.hand.push(player.deck[Math.floor(Math.random()*player.deck.length)]);
  }
  update();
}

function playCard(i){
  let c=player.hand[i];
  if(c.cost>player.energy)return;
  player.energy-=c.cost;

  if(c.damage){
    enemy.hp-=c.damage;
    floatText("-"+c.damage,230,80);
    sfx(180);
  }
  if(c.heal){
    player.hp=Math.min(player.maxHp,player.hp+c.heal);
    floatText("+"+c.heal,230,200,"#4f4");
    sfx(600);
  }

  if(enemy.hp<=0){
    startBattle();
    return;
  }

  enemyTurn();
  startTurn();
}

function enemyTurn(){
  player.hp-=enemy.damage;
  floatText("-"+enemy.damage,230,200);
  sfx(120);
}

/* ===== BATTLE ===== */
function startBattle(){
  enemy.hp=enemy.maxHp;
  enemy.sprite = characters[Math.floor(Math.random()*characters.length)];
  player.sprite = characters[Math.floor(Math.random()*characters.length)];
  startTurn();
}

/* ===== UI ===== */
function update(){
  document.getElementById("stats").innerText=
    `❤️ ${player.hp}/${player.maxHp} ⚡ ${player.energy}`;
  drawHand();
  draw();
}

function floatText(text,x,y,color="#f44"){
  let d=document.createElement("div");
  d.className="float";
  d.style.left=x+"px";
  d.style.top=y+"px";
  d.style.color=color;
  d.innerText=text;
  document.getElementById("arena").appendChild(d);
  setTimeout(()=>d.remove(),1000);
}

/* ===== LOOP ===== */
function loop(){
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
