<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Personal Operating System</title>
</head>

<body>
<h1>Personal Operating System</h1>

<nav>
  <button onclick="showTab('tasks')">Tasks</button>
  <button onclick="showTab('planner')">Planner</button>
  <button onclick="showTab('habits')">Habits</button>
  <button onclick="showTab('health')">Health</button>
  <button onclick="showTab('finance')">Finance</button>
</nav>

<section id="tasks">
  <h2>Tasks</h2>
  <input id="taskInput" placeholder="New task">
  <button onclick="addTask()">Add</button>
  <ul id="taskList"></ul>
</section>

<section id="planner" style="display:none">
  <h2>Planner</h2>
  <textarea id="dailyPlan" placeholder="Daily plan"></textarea>
  <button onclick="savePlanner()">Save</button>
</section>

<section id="habits" style="display:none">
  <h2>Habits</h2>
  <input id="habitInput" placeholder="New habit">
  <button onclick="addHabit()">Add</button>
  <ul id="habitList"></ul>
</section>

<section id="health" style="display:none">
  <h2>Health</h2>
  <input id="water" placeholder="Water">
  <input id="sleep" placeholder="Sleep">
  <button onclick="saveHealth()">Save</button>
</section>

<section id="finance" style="display:none">
  <h2>Finance</h2>
  <select id="finType">
    <option>Income</option>
    <option>Expense</option>
    <option>Saving</option>
  </select>
  <input id="finAmount" type="number" placeholder="Amount">
  <button onclick="addFinance()">Add</button>
  <ul id="financeList"></ul>
</section>

<script>
const STORAGE_KEY = "PERSONAL_OS_V1";

function loadState(){
  return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {
    tasks: [],
    planner: {},
    habits: [],
    health: {},
    finance: []
  };
}

function saveState(state){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

function showTab(id){
  document.querySelectorAll("section").forEach(s => s.style.display = "none");
  document.getElementById(id).style.display = "block";
}

/* TASKS */
function addTask(){
  const state = loadState();
  const text = taskInput.value;
  if(!text) return;
  state.tasks.push({ text, done:false });
  saveState(state);
  taskInput.value = "";
  renderTasks();
}

function renderTasks(){
  const state = loadState();
  taskList.innerHTML = "";
  state.tasks.forEach((t,i)=>{
    const li = document.createElement("li");
    li.textContent = t.done ? "âœ” " + t.text : t.text;
    li.onclick = ()=>{
      state.tasks[i].done = !state.tasks[i].done;
      saveState(state);
      renderTasks();
    };
    taskList.appendChild(li);
  });
}

/* PLANNER */
function savePlanner(){
  const state = loadState();
  state.planner.daily = dailyPlan.value;
  saveState(state);
}

/* HABITS */
function addHabit(){
  const state = loadState();
  const name = habitInput.value;
  if(!name) return;
  state.habits.push({ name, streak:0 });
  saveState(state);
  habitInput.value = "";
  renderHabits();
}

function renderHabits(){
  const state = loadState();
  habitList.innerHTML = "";
  state.habits.forEach((h,i)=>{
    const li = document.createElement("li");
    li.innerHTML = `${h.name} (${h.streak}) <button onclick="incHabit(${i})">+</button>`;
    habitList.appendChild(li);
  });
}

function incHabit(i){
  const state = loadState();
  state.habits[i].streak++;
  saveState(state);
  renderHabits();
}

/* HEALTH */
function saveHealth(){
  const state = loadState();
  state.health = { water: water.value, sleep: sleep.value };
  saveState(state);
}

/* FINANCE */
function addFinance(){
  const state = loadState();
  const amt = Number(finAmount.value);
  if(!amt) return;
  state.finance.push({ type: finType.value, amount: amt });
  saveState(state);
  finAmount.value = "";
  renderFinance();
}

function renderFinance(){
  const state = loadState();
  financeList.innerHTML = "";
  state.finance.forEach(f=>{
    const li = document.createElement("li");
    li.textContent = `${f.type}: ${f.amount}`;
    financeList.appendChild(li);
  });
}

renderTasks();
renderHabits();
renderFinance();
</script>

</body>
</html>
