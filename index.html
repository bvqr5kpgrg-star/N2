<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Anti Doomscroll â€“ Face & Eye Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: #0a0f1f;
  color: #00ffcc;
  font-family: system-ui;
  text-align: center;
}

video, canvas {
  width: 100vw;
  height: 100vh;
  object-fit: cover;
  position: absolute;
  top: 0;
  left: 0;
}

#status {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.7);
  padding: 10px 20px;
  border-radius: 20px;
  font-size: 14px;
  z-index: 10;
}
</style>

<!-- MediaPipe -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>
</head>

<body>

<video id="video" autoplay muted playsinline></video>
<canvas id="canvas"></canvas>
<div id="status">Requesting cameraâ€¦</div>

<script>
const videoElement = document.getElementById("video");
const canvasElement = document.getElementById("canvas");
const canvasCtx = canvasElement.getContext("2d");
const statusText = document.getElementById("status");

canvasElement.width = window.innerWidth;
canvasElement.height = window.innerHeight;

const faceMesh = new FaceMesh({
  locateFile: (file) =>
    `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`,
});

faceMesh.setOptions({
  maxNumFaces: 1,
  refineLandmarks: true,
  minDetectionConfidence: 0.6,
  minTrackingConfidence: 0.6,
});

faceMesh.onResults(results => {
  canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);

  if (results.multiFaceLandmarks && results.multiFaceLandmarks.length > 0) {
    statusText.innerText = "ðŸ‘€ Face Detected â€“ Tracking Eyes";

    for (const landmarks of results.multiFaceLandmarks) {

      // Draw eyes only
      drawConnectors(canvasCtx, landmarks, FACEMESH_LEFT_EYE, {color: "#00ffcc"});
      drawConnectors(canvasCtx, landmarks, FACEMESH_RIGHT_EYE, {color: "#00ffcc"});

      // Draw pupils
      drawLandmarks(canvasCtx, landmarks, {
        color: "#ff0044",
        radius: 1
      });
    }

  } else {
    statusText.innerText = "âš ï¸ No face detected â€“ Look at screen";
  }
});

const camera = new Camera(videoElement, {
  onFrame: async () => {
    await faceMesh.send({ image: videoElement });
  },
  width: 640,
  height: 480,
});

camera.start();
</script>

</body>
</html>
